$(function() {

  let stage = 'か';

  function ka (evt) {
    if(stage == 'か'){
    $("#sign_temp").text("これは指文字の【か】です");
    $('.circle').css('display','inline');
    setTimeout(function(){
        $('.handsign_img').attr("src","../img/handsign/handsign_ki.png");
        $(".circle").css('display','none');
        $(".handsign_text").text("手できつねを作ってみよう！");
        $("#sign_temp").text("？");
        stage = 'き';
      }, 2000);
    }else{
      $("#sign_temp").text("やりなおしてください");
    }
  }

  function ki (evt) {
    if(stage == 'き'){
      $("#sign_temp").text("これは指文字の【き】です");
      $('.circle').css('display','inline');
      setTimeout(function(){
        $('.handsign_img').attr("src","../img/handsign/handsign_ku.png");
        $(".circle").css('display','none');
        $(".handsign_text").text("手を伸ばして横にしよう！");
        $("#sign_temp").text("？");
        stage = 'く';
      }, 2000);
    }else{
      $("#sign_temp").text("やりなおしてください");
    }
  }

  function ku (evt) {
    if(stage == 'く'){
      $("#sign_temp").text("これは指文字の【く】です");
      $('.circle').css('display','inline');
      setTimeout(function(){
        $('.handsign_img').attr("src","../img/handsign/handsign_ke.png");
        $(".circle").css('display','none');
        $(".handsign_text").text("！");
        $("#sign_temp").text("？");
        stage = 'け';
      }, 2000);
    }else{
      $("#sign_temp").text("やりなおしてください");
    }
  }

  function ke (evt) {
    if(stage == 'け'){
      $("#sign_temp").text("これは指文字の【け】です");
      $('.circle').css('display','inline');
      setTimeout(function(){
        $('.handsign_img').attr("src","../img/handsign/handsign_ko.png");
        $(".circle").css('display','none');
        $(".handsign_text").text("輪っかを作ってみよう！");
        $("#sign_temp").text("？");
        stage = 'こ';
      }, 2000);
    }else{
      $("#sign_temp").text("やりなおしてください");
    }
  }

  function ko (evt) {
    if(stage == 'こ'){
      $("#sign_temp").text("これは指文字の【こ】です");
      $('.circle').css('display','inline');
      setTimeout(function(){
        $("#sign_temp").text("？");
      }, 2000);
    }else{
      $("#sign_temp").text("やりなおしてください");
    }
  }

  var trainer = new LeapTrainer.Controller();

  /*幾何学テンプレートマッチング
  **************************************************************************************/
  
  /*か（正解）*********************************************************/
  trainer.fromJSON('{"name":"KA","pose":true,"data":[[{"x":0.049894280908940686,"y":0.04317393437509509,"z":0.28941564530920216,"stroke":1},{"x":0.027144097958073682,"y":0.04610074092128946,"z":0.23686145156359928,"stroke":1},{"x":0.00439391500720665,"y":0.049027547467483834,"z":0.1843072578179964,"stroke":1},{"x":-0.08143229387422099,"y":-0.13830222276386844,"z":-0.7105843546907978,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KA2","pose":true,"data":[[{"x":0.03708958539212467,"y":0.012701742231206452,"z":0.2874395940517631,"stroke":1},{"x":0.01650149038919308,"y":0.016159337909125687,"z":0.23752013531607896,"stroke":1},{"x":-0.004086604613738491,"y":0.01961693358704493,"z":0.18760067658039492,"stroke":1},{"x":-0.04950447116757924,"y":-0.04847801372737709,"z":-0.7125604059482369,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KA3","pose":true,"data":[[{"x":-0.017371743833104792,"y":0.25065738933209936,"z":0.23400407988279137,"stroke":1},{"x":-0.014230880879828581,"y":0.16756268790403606,"z":0.20566734664713193,"stroke":1},{"x":-0.01109001792655237,"y":0.08446798647597265,"z":0.17733061341147238,"stroke":1},{"x":-0.007949154973276161,"y":0.001373285047909234,"z":0.14899388017581294,"stroke":1},{"x":0.0506417976127619,"y":-0.5040613487600174,"z":-0.7659959201172086,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KA4","pose":true,"data":[[{"x":0.04693428012515566,"y":0.12011676616916644,"z":0.3882249483265877,"stroke":1},{"x":-0.03711318400874769,"y":0.1323963623800397,"z":0.15041425618662163,"stroke":1},{"x":-0.12116064814265096,"y":0.14467595859091298,"z":-0.08739643595334468,"stroke":1},{"x":-0.20520811227655428,"y":0.15695555480178625,"z":-0.32520712809331087,"stroke":1},{"x":-0.2892555764104576,"y":0.1692351510126595,"z":-0.5630178202332771,"stroke":1},{"x":0.6058032407132549,"y":-0.723379792954565,"z":0.43698217976672293,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KA5","pose":true,"data":[[{"x":0.051214166404738415,"y":0.17982191520087143,"z":0.33449069309735147,"stroke":1},{"x":-0.025998688398224584,"y":0.15096004989539125,"z":0.11970896748420079,"stroke":1},{"x":-0.1032115432011875,"y":0.12209818458991106,"z":-0.09507275812894977,"stroke":1},{"x":-0.18042439800415047,"y":0.09323631928443088,"z":-0.3098544837421004,"stroke":1},{"x":-0.2576372528071134,"y":0.06437445397895059,"z":-0.524636209355251,"stroke":1},{"x":0.5160577160059376,"y":-0.6104909229495552,"z":0.475363790644749,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KA6","pose":true,"data":[[{"x":0.01262366525036061,"y":0.09867557569725144,"z":0.28932208402281234,"stroke":1},{"x":-0.005801567861603702,"y":0.0857111303198907,"z":0.23689263865906252,"stroke":1},{"x":-0.024226800973568014,"y":0.07274668494252995,"z":0.1844631932953127,"stroke":1},{"x":0.017404703584811106,"y":-0.257133390959672,"z":-0.7106779159771877,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KA7","pose":true,"data":[[{"x":0.03557943532253666,"y":0.1448676333095048,"z":0.36550511818969045,"stroke":1},{"x":-0.04364749823399003,"y":0.12832206905331678,"z":0.13743149610839456,"stroke":1},{"x":-0.12287443179051671,"y":0.11177650479712886,"z":-0.09064212597290139,"stroke":1},{"x":-0.20210136534704343,"y":0.09523094054094083,"z":-0.31871574805419733,"stroke":1},{"x":-0.28132829890357014,"y":0.0786853762847528,"z":-0.5467893701354932,"stroke":1},{"x":0.6143721589525838,"y":-0.558882523985644,"z":0.4532106298645068,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KA8","pose":true,"data":[[{"x":0.006318320084992925,"y":-0.03640332112239536,"z":0.15628762077154923,"stroke":1},{"x":-0.008501404426220875,"y":0.02895716552369204,"z":0.1630761065104902,"stroke":1},{"x":-0.023321128937434668,"y":0.0943176521697795,"z":0.16986459224943107,"stroke":1},{"x":-0.03814085344864847,"y":0.15967813881586684,"z":0.17665307798837204,"stroke":1},{"x":-0.0033379661468242172,"y":0.155894354355201,"z":0.15746552449178597,"stroke":1},{"x":0.0669830328741353,"y":-0.4024439897421443,"z":-0.823346922011628,"stroke":1}]]}');

  /*き（正解）*********************************************************/
  trainer.fromJSON('{"name":"KI","pose":true,"data":[[{"x":-0.23755662003615916,"y":-0.17595888842349822,"z":0.3164483599332468,"stroke":1},{"x":-0.23500494054694276,"y":-0.22388898341926558,"z":0.2278505466889178,"stroke":1},{"x":-0.2324532610577264,"y":-0.27181907841503294,"z":0.13925273344458866,"stroke":1},{"x":0.7050148216408283,"y":0.6716669502577967,"z":-0.6835516400667532,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KI2","pose":true,"data":[[{"x":-0.032525771053042385,"y":-0.15594751821830996,"z":0.37104684595052173,"stroke":1},{"x":-0.11721192317540197,"y":-0.09625524754326663,"z":0.22850780765842027,"stroke":1},{"x":-0.2018980752977616,"y":-0.036562976868223296,"z":0.08596876936631881,"stroke":1},{"x":-0.28658422742012124,"y":0.02312929380682005,"z":-0.05657026892578254,"stroke":1},{"x":0.6382199969463273,"y":0.2656364488229799,"z":-0.6289531540494783,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KI3","pose":true,"data":[[{"x":-0.1062926351597431,"y":0.10720709813305218,"z":0.31139099094507916,"stroke":1},{"x":-0.15449925907494216,"y":0.06067319029828672,"z":0.22953633635164017,"stroke":1},{"x":-0.20270588299014122,"y":0.014139282463521669,"z":0.14768168175820118,"stroke":1},{"x":0.46349777722482643,"y":-0.1820195708948606,"z":-0.6886090090549208,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KI4","pose":true,"data":[[{"x":-0.05958312310570883,"y":0.06625696364579137,"z":0.3088843375889657,"stroke":1},{"x":-0.11014828057096251,"y":0.04283468775509702,"z":0.23037188747034476,"stroke":1},{"x":-0.1607134380362162,"y":0.01941241186440265,"z":0.1518594373517237,"stroke":1},{"x":0.33044484171288757,"y":-0.128504063265291,"z":-0.6911156624110343,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KI5","pose":true,"data":[[{"x":-0.055315415089866427,"y":0.11786273751427712,"z":0.2418284030829032,"stroke":1},{"x":-0.09637792083670595,"y":0.016994589434089935,"z":0.20697140051381713,"stroke":1},{"x":-0.13744042658354547,"y":-0.08387355864609725,"z":0.17211439794473138,"stroke":1},{"x":-0.178502932330385,"y":-0.18474170672628443,"z":0.1372573953756454,"stroke":1},{"x":0.4676366948405028,"y":0.13375793842401462,"z":-0.7581715969170968,"stroke":1}]]}');

  /*く（正解）*********************************************************/
  trainer.fromJSON('{"name":"KU","pose":true,"data":[[{"x":0.14128797151914962,"y":-0.15235080777746798,"z":0.15866514902937956,"stroke":1},{"x":0.12828881737169862,"y":-0.08068436997176519,"z":0.053132346869096625,"stroke":1},{"x":0.1152896632242475,"y":-0.009017932166062392,"z":-0.05240045529118614,"stroke":1},{"x":0.10229050907679649,"y":0.06264850563964039,"z":-0.15793325745146902,"stroke":1},{"x":0.08929135492934537,"y":0.13431494344534348,"z":-0.2634660596117518,"stroke":1},{"x":0.07629220078189436,"y":0.20598138125104629,"z":-0.36899886177203467,"stroke":1},{"x":-0.6527405169031321,"y":-0.16089172042073455,"z":0.6310011382279653,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KU2","pose":true,"data":[[{"x":0.26362804360513825,"y":-0.0400517523764592,"z":0.0017923407664663382,"stroke":1},{"x":0.24545731879828736,"y":0.01491395993671972,"z":-0.04912544249202787,"stroke":1},{"x":0.22728659399143636,"y":0.06987967224989865,"z":-0.10004322575052207,"stroke":1},{"x":-0.7363719563948617,"y":-0.044741879810159174,"z":0.14737632747608365,"stroke":1}]]}');

  /*け（正解）*********************************************************/
  trainer.fromJSON('{"name":"KE","pose":true,"data":[[{"x":-0.004969314009633755,"y":0.185302251003064,"z":0.23006320151630544,"stroke":1},{"x":-0.026122726475389157,"y":0.08714019039018614,"z":0.19202528060652224,"stroke":1},{"x":-0.04727613894114456,"y":-0.011021870222691688,"z":0.15398735969673882,"stroke":1},{"x":-0.06842955140689996,"y":-0.1091839308355695,"z":0.11594943878695552,"stroke":1},{"x":-0.08958296387265534,"y":-0.20734599144844754,"z":0.07791151787717221,"stroke":1},{"x":0.2363806947057227,"y":0.05510935111345858,"z":-0.7699367984836946,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KE2","pose":true,"data":[[{"x":0.09093724845557782,"y":0.3472222222222223,"z":0.15575464740947625,"stroke":1},{"x":0.08002477864090851,"y":0.30555555555555525,"z":0.13706408972033912,"stroke":1},{"x":-0.17096202709648634,"y":-0.6527777777777777,"z":-0.29281873712981543,"stroke":1}]]}');

  /*こ（正解）*********************************************************/
  trainer.fromJSON('{"name":"KO","pose":true,"data":[[{"x":0.23113443155354968,"y":-0.34722222222222227,"z":0.005126544034532974,"stroke":1},{"x":0.2033982997671237,"y":-0.3055555555555555,"z":0.004511358750389032,"stroke":1},{"x":-0.43453273132067344,"y":0.6527777777777777,"z":-0.009637902784922004,"stroke":1}]]}');
  trainer.fromJSON('{"name":"KO2","pose":true,"data":[[{"x":0.29709856399302115,"y":0.061629129534496896,"z":0.060511765523686534,"stroke":1},{"x":0.23430047866899284,"y":0.06505165521303358,"z":0.053704911681180606,"stroke":1},{"x":0.17150239334496464,"y":0.06847418089157031,"z":0.046898057838674706,"stroke":1},{"x":-0.7029014360069789,"y":-0.19515496563910073,"z":-0.1611147350435419,"stroke":1}]]}');

  //trainer.fromJSON('');
  
  //か
  trainer.on('KA', ka);
  trainer.on('KA2', ka);
  trainer.on('KA3', ka);
  trainer.on('KA4', ka);
  trainer.on('KA5', ka);
  trainer.on('KA6', ka);
  trainer.on('KA7', ka);
  trainer.on('KA8', ka);

  //き
  trainer.on('KI', ki);
  trainer.on('KI2', ki);
  trainer.on('KI3', ki);
  trainer.on('KI4', ki);
  trainer.on('KI5', ki);

  //く
  trainer.on('KU', ku);
  trainer.on('KU2', ku);

  //け
  trainer.on('KE', ke);
  trainer.on('KE2', ke);

  //こ
  trainer.on('KO', ko);
  trainer.on('KO2', ko);

});